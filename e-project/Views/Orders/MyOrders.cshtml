@model List<e_project.Models.Order>

@{
    ViewData["Title"] = "My Orders";
}
<main class="main">

    <!-- Page Title -->
    <div class="page-title" data-aos="fade">
        <div class="heading">
            <div class="container">
                <div class="row d-flex justify-content-center text-center">
                    <div class="col-lg-8">
                        <h1 class="fw-bold">📸 My Photo Orders</h1>
                        <p class="mb-0">Track your uploaded photos, printing status, and order history.</p>
                    </div>
                </div>
            </div>
        </div>
        <nav class="breadcrumbs">
            <div class="container">
                <ol>
                    <li><a href="/">Home</a></li>
                    <li><a href="#">Account</a></li>
                    <li class="current">My Orders</li>
                </ol>
            </div>
        </nav>
    </div>

    <!-- Orders Section -->
    <section id="orders" class="orders section">
        <div class="container" data-aos="fade-up" data-aos-delay="100">

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="statusFilter" class="form-label">Filter by Status:</label>
                    <select class="form-select w-auto d-inline-block" id="statusFilter" onchange="filterTable()">
                        <option value="">All</option>
                        <option value="Pending">Pending</option>
                        <option value="Delivered">Delivered</option>
                    </select>
                </div>
            </div>
            <div class="row gy-4">
                <div class="col-lg-12">
@if (!Model.Any())
{
    <div class="alert alert-info">You haven’t placed any orders yet.</div>
}
else
{
    foreach (var order in Model)
    {
                            <div class="card mb-4 shadow-sm" data-status="@order.Status">

                                <div class="card-header bg-order-header text-white">
                <strong>Order #@order.Id</strong> - Placed on @order.OrderDate.ToString("dd MMM yyyy")
            </div>
            <div class="card-body">
                <p><strong>Payment:</strong> @order.PaymentMethod</p>
                <p><strong>Shipping Address:</strong> @order.ShippingAddress</p>
                                    <p>
                                        <strong>Status:</strong>
                                        @if (order.Status == "Pending")
                                        {
                                            <span class="badge bg-warning">Pending</span>
                                        }
                                        else if (order.Status == "Delivered")
                                        {
                                            <span class="badge bg-success">Delivered</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-secondary">@order.Status</span>
                                        }
                                    </p>

                            <h5>Photos in this order:</h5>
                                    <table class="table table-bordered table-sm table-rounded">

                    <thead class="thead-light">
                        <tr>
                            <th>Preview</th>
                            <th>Print Size</th>
                            <th>Quantity</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in order.PhotoOrderItems)
                        {
                            <tr>
                                <td>
                                                        <img src="@item.PhotoFilePath"
                                                             alt="Photo"
                                                             class="img-fluid rounded shadow-sm"
                                                             style="max-width: 100px; cursor:pointer;"
                                                             onclick="showModal('@item.PhotoFilePath')" />
                                </td>
                                <td>@item.PrintSize</td>
                                <td>@item.Quantity</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
}
                </div>
            </div>

            <div class="row gy-4 mt-4">
                <div class="col-lg-12 text-center">
                    <a asp-action="Create" asp-controller="Orders" class="btn btn-success px-4 py-2 rounded-pill shadow-sm fs-5">
                        ➕ Place a New Order
                    </a>
                </div>
            </div>

        </div>
    </section>

</main>

<!-- Modal for Image Viewer -->
<div class="modal fade" id="photoModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content bg-transparent border-0">
            <img id="modalImage" class="img-fluid rounded shadow" />
        </div>
    </div>
</div>
<style>
    /* Table Styling */
    .table th, .table td {
        vertical-align: middle;
    }

    .table th {
        background-color: #2eca6a !important;
        color: white;
        font-weight: 600;
        text-align: center;
    }

    .table td {
        text-align: center;
    }

    /* Status Badges */
    .badge.bg-warning {
        background-color: #ffc107 !important;
        color: #333;
    }

    .badge.bg-success {
        background-color: #2eca6a !important;
    }

    .badge.bg-secondary {
        background-color: #6c757d !important;
    }

    /* Cards */
    .card {
        border-radius: 12px;
        border: 1px solid #e0e0e0;
        transition: box-shadow 0.3s ease;
    }

        .card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

    .card-header {
        border-top-left-radius: 12px;
        border-top-right-radius: 12px;
        font-size: 1.1rem;
    }

    .card-body p {
        margin-bottom: 0.5rem;
    }

    /* Filter Dropdown */
    #statusFilter {
        border: 2px solid #2eca6a;
        border-radius: 0.6rem;
        padding: 6px 14px;
        font-size: 1rem;
        color: #343a40;
        background-color: #fff;
        transition: all 0.3s ease;
    }

        #statusFilter:focus {
            outline: none;
            border-color: #2eca6a;
            box-shadow: 0 0 0 0.15rem rgba(46, 202, 106, 0.25);
        }

    /* Photo Thumbnails */
    .img-fluid.rounded.shadow-sm {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .img-fluid.rounded.shadow-sm:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

    /* Modal Styling */
    .modal-content {
        background-color: rgba(0, 0, 0, 0.85);
        padding: 1rem;
        text-align: center;
    }

    #modalImage {
        max-height: 80vh;
        object-fit: contain;
    }

    /* Place New Order Button */
    .btn-success {
        background-color: #2eca6a;
        border-color: #2eca6a;
        font-weight: 600;
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }

        .btn-success:hover {
            background-color: #28b65b;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }

    .bg-order-header {
        background-color: #2eca6a !important;
        color: #ffffff;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .table-rounded {
        border-collapse: separate;
        border-spacing: 0;
        border: 1px solid #dee2e6;
        border-radius: 0.75rem;
        overflow: hidden;
    }

        /* Apply rounding to the header cells */
        .table-rounded th:first-child {
            border-top-left-radius: 0.75rem;
        }

        .table-rounded th:last-child {
            border-top-right-radius: 0.75rem;
        }

        /* Apply rounding to the bottom row */
        .table-rounded tr:last-child td:first-child {
            border-bottom-left-radius: 0.75rem;
        }

        .table-rounded tr:last-child td:last-child {
            border-bottom-right-radius: 0.75rem;
        }



</style>


<script>
    function showModal(src) {
        document.getElementById('modalImage').src = src;
        var modal = new bootstrap.Modal(document.getElementById('photoModal'));
        modal.show();
    }

 
            function filterTable() {
        var selectedStatus = document.getElementById('statusFilter').value;
        var cards = document.querySelectorAll('.card[data-status]');

        cards.forEach(card => {
            var status = card.getAttribute('data-status');
            if (!selectedStatus || status === selectedStatus) {
                card.style.display = '';
            } else {
                card.style.display = 'none';
            }
        });
    }

</script>